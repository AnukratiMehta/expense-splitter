<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Edit Expense</title>
  <link rel="stylesheet" href="/css/styles.css">
</head>

<body>

<!-- NAVBAR -->
<div class="navbar">
  <div>
    <a href="/">Home</a>
    <a href="/groups">Groups</a>
  </div>

  <div>
    <span>Logged in as <strong><%= currentUser.username %></strong></span>
    <form action="/logout" method="POST" style="display:inline;">
      <input type="hidden" name="_csrf" value="<%= csrfToken %>">
      <button class="small-btn" type="submit">Logout</button>
    </form>
  </div>
</div>

<div class="container">
  <% if (success) { %>
  <div class="notice" style="background:#d8f8d8; border:1px solid #a6e8a6; margin-bottom:1rem;">
    <strong><%= success %></strong>
  </div>
<% } %>

<% if (error) { %>
  <div class="notice" style="background:#ffd3d3; border:1px solid #ff9e9e; margin-bottom:1rem;">
    <strong><%= error %></strong>
  </div>
<% } %>


  <h1>Edit Expense</h1>

  <form action="/groups/<%= groupId %>/expenses/<%= expense.id %>/edit" method="POST">
    <input type="hidden" name="_csrf" value="<%= csrfToken %>">

    <label>Description</label>
    <input
      type="text"
      name="description"
      value="<%= expense.description %>"
      required
    >

    <label>Total Amount (€)</label>
    <input
      type="number"
      step="0.01"
      name="amount"
      value="<%= expense.amount %>"
      required
    >

    <h3>Split Between Members</h3>

    <% members.forEach(m => { %>
      <div style="margin-bottom: 0.5rem;">
        <label><%= m.username %></label>

        <input
          type="number"
          step="0.01"
          name="splits[<%= m.id %>]"
          value="<%= splitMap[m.id] || 0 %>"
          required
        >
      </div>
    <% }) %>

    <button type="submit">Save Changes</button>
  </form>

  <p style="margin-top: 1rem;">
    <a href="/groups/<%= groupId %>">← Back to Group</a>
  </p>

</div>

</body>
</html>
